# 决策摘要 - 快速参考

**Change ID**: `add-json-parser-tool`  
**最后更新**: 2025-11-08

> 这是所有技术决策的快速参考表。详细信息请查看 [DECISIONS.md](./DECISIONS.md)

## ✅ 已确定的决策

### 核心技术栈

| 类别 | 选择 | 版本 | 状态 |
|------|------|------|------|
| 前端框架 | Next.js (App Router) | 14+ | ✅ 确定 |
| UI 库 | React | 18+ | ✅ 确定 |
| 类型系统 | TypeScript | 5+ | ✅ 确定 |
| 样式方案 | Tailwind CSS | 3+ | ✅ 确定 |
| 代码编辑器 | **Monaco Editor** | ^4.6.0 | ✅ 确定 |
| UI 组件库 | **shadcn/ui** + 自定义 | - | ✅ 确定 |
| 状态管理 | React Hooks + Context | - | ✅ 确定 |
| 测试框架 | **Vitest** + RTL | ^1.0.0 | ✅ 确定 |
| 部署平台 | **Cloudflare Pages** | - | ✅ 确定 |

### 文件大小策略

```typescript
警告阈值: 5MB   // 显示警告，用户知情
Worker阈值: 10MB  // 自动使用 Web Worker
硬性限制: 20MB  // 拒绝处理
```

### 性能目标

| 文件大小 | 处理时间目标 |
|---------|-------------|
| < 100KB | < 500ms |
| 100KB - 1MB | < 1s |
| 1MB - 10MB | < 3s |
| 10MB - 20MB | < 5s |

### UI/UX 决策

| 项目 | 决策 |
|------|------|
| 主题 | v1.0 仅暗色主题，v1.1 添加主题切换 |
| 语言 | v1.0 仅中文，v1.1 添加国际化 |
| 错误提示 | Toast (3-5秒) + 固定面板 |
| 防抖延迟 | 固定 500ms |
| 断点 | 768px (平板), 1024px (桌面) |

### 测试策略

| 类型 | 工具 | 覆盖率目标 |
|------|------|-----------|
| 单元测试 | Vitest | > 90% |
| 组件测试 | React Testing Library | > 70% |
| E2E 测试 | Playwright (可选) | 关键流程 |
| 无障碍性 | Lighthouse + axe | WCAG 2.1 AA |

### 持久化策略

| 数据类型 | 存储方式 | 说明 |
|---------|---------|------|
| 配置选项 | localStorage | 跨会话保存 |
| 折叠状态 | sessionStorage | 仅当前会话 |
| JSON 内容 | 不持久化 | 隐私保护 |

## ⏸️ 延后决策

| 项目 | 评估时间 | 触发条件 |
|------|---------|---------|
| 虚拟滚动 | Week 4 (Phase 7) | 如果 > 1000行 且 渲染 > 2s |
| 主题切换 | v1.1 | 用户反馈需求 |
| 国际化 | v1.1 | 有国际用户 |
| 监控分析 | v1.1 | 需要用户数据 |

## ❌ 已拒绝的方案

| 方案 | 理由 |
|------|------|
| CodeMirror | 功能不如 Monaco 强大 |
| 现成 JSON 编辑器 | 定制化能力有限 |
| Redux/Zustand | 应用状态简单，过度设计 |
| JSON5 支持 | 增加复杂度，标准 JSON 已足够 |

## 📋 检查清单

在开始开发前，确认以下事项：

### Week 1 前必须确认
- [x] Monaco Editor vs CodeMirror → **Monaco Editor**
- [x] 文件大小限制 → **5MB 警告, 10MB Worker, 20MB 限制**
- [x] UI 组件库 → **shadcn/ui + 自定义**
- [x] 部署平台 → **Cloudflare Pages**
- [x] 测试框架 → **Vitest + React Testing Library**

### Week 4 前需要决策
- [ ] 虚拟滚动是否实现 → 根据性能测试
- [ ] 性能优化策略是否足够 → 数据驱动

### v1.1 前需要决策
- [ ] 主题切换实现方案
- [ ] 国际化实现方案
- [ ] 是否添加分析工具
- [ ] 是否添加 PWA 支持

## 🎯 快速决策指南

### 如果用户要求添加功能：

1. **判断优先级**
   - P0: 影响核心功能 → 立即评估
   - P1: 增强用户体验 → 规划到 v1.1
   - P2: Nice to have → 记录到 backlog

2. **评估影响**
   - 是否影响已有决策？
   - 是否需要新增依赖？
   - 是否影响性能目标？

3. **更新文档**
   - 在 DECISIONS.md 中记录新决策
   - 更新 tasks.md 相关任务
   - 更新 proposal.md（如有重大变更）

### 如果遇到技术问题：

1. **查阅决策文档**
   - 检查 DECISIONS.md 是否有相关决策
   - 查看决策理由和替代方案

2. **评估是否需要重新决策**
   - 原决策是否基于错误假设？
   - 是否有新的信息或工具？
   - 改变决策的成本和收益？

3. **记录变更**
   - 在 DECISIONS.md 中更新状态
   - 标注变更日期和原因
   - 通知相关开发人员

## 🔗 相关文档

- 📘 [完整决策记录](./DECISIONS.md) - 详细的 ADR 文档
- 📝 [变更提案](./proposal.md) - 整体方案
- ✅ [任务清单](./tasks.md) - 实施步骤
- 📖 [README](./README.md) - 项目总览

## 📞 获取帮助

- 技术决策问题 → 查看 DECISIONS.md
- 实施细节问题 → 查看 design.md
- 任务优先级问题 → 查看 tasks.md
- 需求理解问题 → 查看 specs/json-parser-tool/spec.md

---

**提示**: 这是一个动态文档，会随着项目进展更新。每次重要决策后都应更新此文件。
